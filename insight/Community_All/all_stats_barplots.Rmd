# Create bar plot
This script uses summary statistic data to create a bar plot.

```{r}
library(tidyverse)
```

```{r}
# setwd("C:/Users/vkuchhal/Documents/hepa-summer23")
summary_df <- read_csv("C:/Users/vkuchhal/Documents/hepa-summer23/summary/Community_All/s_All_M_quants.csv")

```

```{r}
stat_order <- c("q5", "q25", "median", "q75", "q95")
summary_df %>% filter(environment == "indoor", type == "pm25", case == "redu",
                      participant_id == "all") %>%
  pivot_longer(cols = mean:sd, names_to = "stat") %>%
  filter(room_type != "all", stat %in% c("q5", "q25", "median", "q75", "q95", "mean")) %>%
  mutate(stat = fct_relevel(stat, "q5", "q25", "median", "q75", "q95")) %>%
  ggplot() + geom_col(aes(x = room_type, y = value, fill = stat), position = "dodge") +
  labs(x = "Deployment Class", y = "Percentage Reduction", fill = "Summary Statistic") +
  scale_fill_discrete(labels = c("5th Percentile", "25th Percentile", "Median", 
                                 "75th Percentile", "95th Percentile", "Mean"))
```

